C51 COMPILER V9.00   SYSTEM                                                                11/04/2017 15:29:16 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE SYSTEM
OBJECT MODULE PLACED IN ..\output\System.obj
COMPILER INVOKED BY: D:\keil\keillc51\keillc51set\C51\BIN\C51.EXE ..\program\System.c BROWSE INCDIR(..\program) DEBUG OB
                    -JECTEXTEND PRINT(..\listing\System.lst) TABS(2) OBJECT(..\output\System.obj)

line level    source

   1          #include"system.h"
   2          #include"lcd12864.h"
   3          #include"Delay.H"
   4          #include"key.h"
   5          #include"buzzer.h"
   6          
   7          /**************************显示页面*****************************/
   8          uchar xdata Display[5][4][17]={
   9            {                                         
  10              {"init"},{"  小球控制系统"},{"  "},{" "}                //第一页
  11            },
  12            {
  13              {"  Set_distance"},{"Expect:00"},{"Distance:"},{"            next"}           //第二页
  14            },
  15            {
  16              {"  Action1"},{"32"},{"33"},{"back        next"}        //第三页
  17            },
  18            {
  19              {"  Action2"},{"42"},{"43"},{"back        next"}            //第四页
  20            },
  21            {
  22              {"  Action3"},{"52"},{"53"},{"back        next"}        //第三页
  23            },
  24          };
  25          uchar key_value[5]={0};
  26          uchar set_buff,actual_dis;
  27          /**************************************************************/
  28          
  29          State System_State=0;
  30          
  31          void Set_Distance()
  32          {
  33   1        int i=0,key_flag=0;
  34   1        key_value[0]=KEY4_scan();//将键值读入输入流
  35   1      
  36   1        switch(key_value[0])
  37   1        {
  38   2          case 1:
  39   2            {
  40   3              System_State = init;
  41   3              Write_comordata(0,0x01);
  42   3              key_value[1]=0;
  43   3            }break;
  44   2          case 2:
  45   2            {
  46   3              if(set_buff==0)                   //0-16
  47   3                  set_buff=16;
  48   3              set_buff--;
  49   3              Display[1][1][8]='0'+set_buff%10; //0
  50   3              Display[1][1][7]='0'+set_buff/10; //10
  51   3      
  52   3            }break;
  53   2          case 3:
  54   2            {
C51 COMPILER V9.00   SYSTEM                                                                11/04/2017 15:29:16 PAGE 2   

  55   3              set_buff++;
  56   3              if(set_buff==16)                  //16-0
  57   3                set_buff=0;
  58   3              Display[1][1][8]='0'+set_buff%10; //0
  59   3              Display[1][1][7]='0'+set_buff/10; //10
  60   3            }break;
  61   2          case 4:
  62   2            {
  63   3              while(1)                                //在此循环中添加控制函数
  64   3              {
  65   4                actual_dis=15;                        //赋值给次变量修改显示的实际距离值
  66   4                Display[1][2][10]='0'+actual_dis%10;  //0
  67   4                Display[1][2][9]='0'+actual_dis/10; //10
  68   4                LCD12864_Display(3,&Display[1][2][0]);
  69   4                if(KEY4_scan()==4)
  70   4                  break;
  71   4              }
  72   3                System_State = action1;
  73   3                Write_comordata(0,0x01);
  74   3                key_value[0]=0;
  75   3            }break;
  76   2          default:break;
  77   2        }
  78   1      }
  79          
  80          void Action1()
  81          {
  82   1        key_value[0]=KEY4_scan();//将键值读入输入流
  83   1        switch(key_value[0])
  84   1        {
  85   2          case 1:
  86   2            {
  87   3              System_State = set_distance;
  88   3              Write_comordata(0,0x01);
  89   3              key_value[1]=0;
  90   3            }break;
  91   2          case 2:
  92   2            {
  93   3              ;
  94   3            }break;
  95   2          case 3:
  96   2            {
  97   3              ;
  98   3            }break;
  99   2          case 4:
 100   2            {
 101   3                System_State = action2;
 102   3                Write_comordata(0,0x01);
 103   3            }break;
 104   2          default:break;
 105   2        }
 106   1      }
 107          
 108          void Action2()
 109          {
 110   1        key_value[0]=KEY4_scan();//将键值读入输入流
 111   1        switch(key_value[0])
 112   1        {
 113   2          case 1:
 114   2            {
 115   3              System_State = action1;
 116   3              Write_comordata(0,0x01);
C51 COMPILER V9.00   SYSTEM                                                                11/04/2017 15:29:16 PAGE 3   

 117   3              key_value[1]=0;
 118   3            }break;
 119   2          case 2:
 120   2            {
 121   3              ;
 122   3            }break;
 123   2          case 3:
 124   2            {
 125   3              ;
 126   3            }break;
 127   2          case 4:
 128   2            {
 129   3                System_State = action3;
 130   3                Write_comordata(0,0x01);
 131   3            }break;
 132   2          default:break;
 133   2        }
 134   1      }
 135          
 136          void Action3()
 137          {
 138   1        key_value[0]=KEY4_scan();//将键值读入输入流
 139   1        switch(key_value[0])
 140   1        {
 141   2          case 1:
 142   2            {
 143   3              System_State = action2;
 144   3              Write_comordata(0,0x01);
 145   3              key_value[1]=0;
 146   3            }break;
 147   2          case 2:
 148   2            {
 149   3              ;
 150   3            }break;
 151   2          case 3:
 152   2            {
 153   3              ;
 154   3            }break;
 155   2          case 4:
 156   2            {
 157   3              System_State = init;
 158   3              Write_comordata(0,0x01);
 159   3            }break;
 160   2          default:break;
 161   2        }
 162   1      }
 163          
 164          void System()
 165          {
 166   1        switch(System_State)
 167   1        {
 168   2          case init:
 169   2            {
 170   3              Write_comordata(0,0x01);                //清屏
 171   3              Delay(5);
 172   3              LCD12864_Display(1,&Display[0][1][0]);  //开机页面
 173   3              Delay(500);
 174   3              Write_comordata(0,0x01);                //清屏
 175   3              Delay(5);
 176   3              System_State=set_distance;
 177   3            }break;
 178   2          case set_distance:
C51 COMPILER V9.00   SYSTEM                                                                11/04/2017 15:29:16 PAGE 4   

 179   2            {
 180   3              LCD12864_Display(1,&Display[1][0][0]);
 181   3              LCD12864_Display(2,&Display[1][1][0]);
 182   3              LCD12864_Display(3,&Display[1][2][0]);
 183   3              LCD12864_Display(4,&Display[1][3][0]);
 184   3              Set_Distance();
 185   3            }break;
 186   2          case action1:
 187   2            {
 188   3              LCD12864_Display(1,&Display[2][0][0]);
 189   3              LCD12864_Display(2,&Display[2][1][0]);
 190   3              LCD12864_Display(3,&Display[2][2][0]);
 191   3              LCD12864_Display(4,&Display[2][3][0]);
 192   3              Action1();
 193   3            }break;
 194   2          case action2:
 195   2            {
 196   3              LCD12864_Display(1,&Display[3][0][0]);
 197   3              LCD12864_Display(2,&Display[3][1][0]);
 198   3              LCD12864_Display(3,&Display[3][2][0]);
 199   3              LCD12864_Display(4,&Display[3][3][0]);
 200   3              Action2();
 201   3            }break;
 202   2          case action3:
 203   2            {
 204   3              LCD12864_Display(1,&Display[4][0][0]);
 205   3              LCD12864_Display(2,&Display[4][1][0]);
 206   3              LCD12864_Display(3,&Display[4][2][0]);
 207   3              LCD12864_Display(4,&Display[4][3][0]);
 208   3              Action3();
 209   3            }break;
 210   2          default :break;
 211   2        }
 212   1      }
 213          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    536    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =    340    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      8       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
